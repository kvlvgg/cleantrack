@namespace Controls

<input class="@inputClasses" value="@Value" @oninput="(ChangeEventArgs e) => ValueChanged.InvokeAsync(e?.Value?.ToString())" @onfocusout="(FocusEventArgs e) => onFocusOut(e)"/>

@code {
    [Parameter]
    public string? Value { get; set; }

    [Parameter]
    public bool Invalid { get; set; } = false;

    [Parameter]
    public EventCallback<string?> ValueChanged { get; set; }

    [Parameter]
    public string Size { get; set; }

    private bool focusOutTriggered = false;

    private string inputClasses => string.Join(" ", new Dictionary<string, bool>()
    {
        {"input", true },
        {$"size-{Size}", Size != string.Empty},
        {"invalid", Invalid && focusOutTriggered }
    }.Where((kv, index) => kv.Value == true).ToDictionary(x => x.Key, x => x.Value).Keys.ToArray<string>());

    private void onFocusOut(FocusEventArgs e)
    {
        focusOutTriggered = true;
    }
}
